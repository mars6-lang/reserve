# Review System - Visual Flow Guide

## ğŸ”„ Complete Reservation & Review Flow

```
STEP 1: MAKE RESERVATION
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Product Page                    â”‚
â”‚ [Qty: 5]  [Total: â‚±750]       â”‚
â”‚           [RESERVE]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
    Order Created
    Status: ACTIVE ğŸŸ¡
           â†“
    âŒ Review Form NOT Shown
    Message: "Leave review when RECEIVED"
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Product Page (ACTIVE Order)     â”‚
â”‚                                 â”‚
â”‚ ğŸ“¦ You can leave a review while â”‚
â”‚ the product is in RECEIVED      â”‚
â”‚ status.                         â”‚
â”‚                                 â”‚
â”‚ (No review form)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

STEP 2: MARK AS RECEIVED
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tracking Page                   â”‚
â”‚ Order: Tomato (ACTIVE ğŸŸ¡)       â”‚
â”‚ [âœ“ Mark as Received] [âœ— Cancel]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
      User Clicks Button
      Confirmation Popup
           â†“
    Order Updated
    Status: RECEIVED ğŸ”µ
           â†“
    âœ… Review Form NOW Shown
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Product Page (RECEIVED Order)   â”‚
â”‚                                 â”‚
â”‚ Leave a Review                  â”‚
â”‚                                 â”‚
â”‚ Rating: [5 Stars dropdown]      â”‚
â”‚ Comment: [Text area]            â”‚
â”‚ Photo: [Upload button]          â”‚
â”‚                                 â”‚
â”‚         [Submit Review]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

STEP 3: SUBMIT REVIEW
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User fills form:                â”‚
â”‚ - Selects 5 stars              â”‚
â”‚ - Writes: "Fresh & crispy!"     â”‚
â”‚ - Clicks Submit                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
      Review Created
      Seller Notified
           â†“
    âœ… "Review posted successfully!"
           â†“
      Page reloads
      Status still: RECEIVED ğŸ”µ
           â†“
    âŒ Review Form NOW HIDDEN
    Message: Already Reviewed
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Product Page (After Review)     â”‚
â”‚                                 â”‚
â”‚ âœ… Thank you! You have already  â”‚
â”‚ reviewed this product. One      â”‚
â”‚ review per product per buyer.   â”‚
â”‚                                 â”‚
â”‚ (No review form)                â”‚
â”‚ (Your review shows above)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

STEP 4: ORDER MOVES TO COMPLETED
       (Later, buyer completes order)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tracking Page                   â”‚
â”‚ Order: Tomato (RECEIVED ğŸ”µ)     â”‚
â”‚ [Order marked as completed]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
    Status: COMPLETED ğŸŸ¢
           â†“
    Product Page Still Shows:
    âœ… "Already reviewed"
    âŒ No review form
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Product Page (COMPLETED)        â”‚
â”‚                                 â”‚
â”‚ âœ… Thank you! You have already  â”‚
â”‚ reviewed this product.          â”‚
â”‚                                 â”‚
â”‚ (Your review still visible)     â”‚
â”‚ (No review form)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš« Scenarios Where Review NOT Allowed

### Scenario 1: Order Still ACTIVE
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Order: Tomato (ACTIVE ğŸŸ¡)       â”‚
â”‚                                 â”‚
â”‚ ğŸ“¦ You can leave a review while â”‚
â”‚ the product is in RECEIVED      â”‚
â”‚ status.                         â”‚
â”‚                                 â”‚
â”‚ No review form shown            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
User Action: Try to submit form â†’ Cannot (form hidden)
```

### Scenario 2: Order Cancelled
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Order: Tomato (CANCELLED âšª)    â”‚
â”‚                                 â”‚
â”‚ ğŸ“¦ You can leave a review while â”‚
â”‚ the product is in RECEIVED      â”‚
â”‚ status.                         â”‚
â”‚                                 â”‚
â”‚ No review form shown            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
User Action: Try to submit form â†’ Cannot (form hidden)
```

### Scenario 3: Already Reviewed
```
First review submitted âœ…
â”‚
Order status: RECEIVED ğŸ”µ
â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… Thank you! You have already  â”‚
â”‚ reviewed this product. One      â”‚
â”‚ review per product per buyer.   â”‚
â”‚                                 â”‚
â”‚ No review form shown            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
User Action: Try to submit form â†’ Cannot (form hidden)
            Try to force submit â†’ Error message shown
```

---

## ğŸ“Š Review Permission Matrix

| Status | Can Review? | Form Shown? | Message |
|--------|-------------|-------------|---------|
| ACTIVE | âŒ No | No | "Leave review when RECEIVED" |
| RECEIVED | âœ… Yes (first time) | Yes | Review form |
| RECEIVED | âŒ No (if reviewed) | No | "Already reviewed" |
| COMPLETED | âŒ No | No | "Already reviewed" |
| CANCELLED | âŒ No | No | "Leave review when RECEIVED" |

---

## âœ… What's Now Protected

```
âœ… Cannot review before receiving order
âœ… Cannot review after completing order
âœ… Cannot review same product twice
âœ… Cannot submit multiple reviews via form
âœ… Cannot submit multiple reviews via API/manual
âœ… Clear error messages for each scenario
âœ… Frontend + Backend logic aligned
```

---

## ğŸ¯ User Journey Map

```
Make Reservation
    â†“
ACTIVE (waiting)
    â”œâ”€ No review form shown âŒ
    â”œâ”€ Message: "Wait for received status"
    â””â”€ Can cancel order
         â†“
Mark as Received
    â†“
RECEIVED (review window open!)
    â”œâ”€ Review form shown âœ…
    â”œâ”€ Can write review
    â”œâ”€ Can upload photo
    â””â”€ Can submit review
         â†“
Review Submitted âœ…
    â†“
RECEIVED (review window closed)
    â”œâ”€ Form hidden âŒ
    â”œâ”€ Message: "Already reviewed"
    â””â”€ Can see own review
         â†“
Complete Order
    â†“
COMPLETED
    â”œâ”€ Form still hidden âŒ
    â”œâ”€ Review still visible âœ…
    â””â”€ Order marked done
```

---

## ğŸ’¡ Key Points

âœ… **Review Window:** Only when status = RECEIVED  
âœ… **One Review Only:** Per user per product  
âœ… **Clear Messaging:** Tells users why form is/isn't shown  
âœ… **Backend Check:** Backend also validates (can't bypass)  
âœ… **User Friendly:** Logical flow, no confusion  

---

## ğŸ§ª Quick Test

```
1. Reserve product          â†’ Status: ACTIVE
2. Check product page       â†’ No review form âŒ
3. Mark as received         â†’ Status: RECEIVED
4. Check product page       â†’ Review form shown âœ…
5. Write & submit review    â†’ Status: RECEIVED (updated)
6. Check product page       â†’ No review form âŒ
                            â†’ "Already reviewed" message
7. Complete order          â†’ Status: COMPLETED
8. Check product page       â†’ Still no review form âŒ
                            â†’ Your review visible âœ…
```

**All tests pass = System working correctly!** âœ…

